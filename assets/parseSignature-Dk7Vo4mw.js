import{M as m,bV as y,bI as w,a5 as x,bX as p,cj as z,cg as M,dO as k,ci as f,dP as P,Z as S,dQ as T,a4 as E,dR as N,bx as B,cc as L,dS as A}from"./index-ee26WOgh.js";function H(s,e){if(s.length!==e.length)throw new m({expectedLength:s.length,givenLength:e.length});const i=[];for(let t=0;t<s.length;t++){const g=s[t],o=e[t];i.push(b(g,o))}return y(i)}function b(s,e,i=!1){if(s==="address"){const n=e;if(!w(n))throw new x({address:n});return p(n.toLowerCase(),{size:i?32:null})}if(s==="string")return z(e);if(s==="bytes")return e;if(s==="bool")return p(M(e),{size:i?32:1});const t=s.match(k);if(t){const[n,r,c="256"]=t,a=Number.parseInt(c,10)/8;return f(e,{size:i?32:a,signed:r==="int"})}const g=s.match(P);if(g){const[n,r]=g;if(Number.parseInt(r,10)!==(e.length-2)/2)throw new S({expectedSize:Number.parseInt(r,10),givenSize:(e.length-2)/2});return p(e,{dir:"right",size:i?32:null})}const o=s.match(T);if(o&&Array.isArray(e)){const[n,r]=o,c=[];for(let a=0;a<e.length;a++)c.push(b(r,e[a],!0));return c.length===0?"0x":y(c)}throw new E(s)}function I(s){const{source:e}=s,i=new Map,t=new N(8192),g=new Map,o=({address:n,chainId:r})=>`${n}.${r}`;return{async consume({address:n,chainId:r,client:c}){const a=o({address:n,chainId:r}),u=this.get({address:n,chainId:r,client:c});this.increment({address:n,chainId:r});const d=await u;return await e.set({address:n,chainId:r},d),t.set(a,d),d},async increment({address:n,chainId:r}){const c=o({address:n,chainId:r}),a=i.get(c)??0;i.set(c,a+1)},async get({address:n,chainId:r,client:c}){const a=o({address:n,chainId:r});let u=g.get(a);return u||(u=(async()=>{try{const l=await e.get({address:n,chainId:r,client:c}),h=t.get(a)??0;return h>0&&l<=h?h+1:(t.delete(a),l)}finally{this.reset({address:n,chainId:r})}})(),g.set(a,u)),(i.get(a)??0)+await u},reset({address:n,chainId:r}){const c=o({address:n,chainId:r});i.delete(c),g.delete(c)}}}const R="0x6492649264926492649264926492649264926492649264926492649264926492";function O(s){const{address:e,data:i,signature:t,to:g="hex"}=s,o=y([B([{type:"address"},{type:"bytes"},{type:"bytes"}],[e,i,t]),R]);return g==="hex"?o:L(o)}function V(s){const{r:e,s:i}=A.Signature.fromCompact(s.slice(2,130)),t=+`0x${s.slice(130)}`,[g,o]=(()=>{if(t===0||t===1)return[void 0,t];if(t===27)return[BigInt(t),0];if(t===28)return[BigInt(t),1];throw new Error("Invalid yParityOrV value")})();return typeof g<"u"?{r:f(e,{size:32}),s:f(i,{size:32}),v:g,yParity:o}:{r:f(e,{size:32}),s:f(i,{size:32}),yParity:o}}export{I as c,H as e,V as p,O as s};
